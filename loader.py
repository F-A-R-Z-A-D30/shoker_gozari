"""
ุณุณุชู ููุฏ ูุญุชูุง ด ููุชูโุง - ูุณุฎู ูุชุตู ุจู MongoDB Atlas
ุณุงุฒฺฏุงุฑ ุจุง Render.com
"""

import importlib
import json
import os
from typing import Dict, Any, List
from pymongo import MongoClient

# --- ุงุชุตุงู ุจู MongoDB ---
MONGO_URI = os.getenv("MONGO_URI")
if not MONGO_URI:
    print("โ ุฎุทุง ุจุญุฑุงู: MONGO_URI ุฏุฑ ูุชุบุฑูุง ูุญุท ุงูุช ูุดุฏ!")

client = MongoClient(MONGO_URI)
db = client['shoker_gozari_db']
users_col = db['users_progress']

# ุณุงุฎุชุงุฑ ธ ููุถูุน ุงุตู - ููุฏ image ุงุถุงูู ุดุฏ
TOPICS = {
    1: {
        "name": "ุณูุงูุช ู ุชูุฏุฑุณุช", 
        "folder": "health_wellness", 
        "emoji": "๐", 
        "color": "#2ecc71", 
        "description": "ุดฺฉุฑฺฏุฒุงุฑ ุจุฑุง ุณูุงูุช ฺฉุงูู ุฌุณู ู ุฑูุงู", 
        "author_quote": "ุณูุงูุช ุจุฒุฑฺฏุชุฑู ูุฏู ุฎุฏุงููุฏ ุงุณุช - ุฑุงูุฏุง ุจุฑู",
        "image": "assets/health.png" # ูพุดโูุฑุถ ุจุฑุง ููุถูุนุงุช ุฏฺฏุฑ
    },
    2: {
        "name": "ุฎุงููุงุฏู ู ุฑูุงุจุท", 
        "folder": "family_relationships", 
        "emoji": "๐จโ๐ฉโ๐งโ๐ฆ", 
        "color": "#e74c3c", 
        "description": "ุดฺฉุฑฺฏุฒุงุฑ ุจุฑุง ูพููุฏูุง ุงูุณุงู ุงุฑุฒุดููุฏ", 
        "author_quote": "ุฎุงููุงุฏู ุจุฒุฑฺฏุชุฑู ูููุจุช ุฒูุฏฺฏ ุงุณุช - ุฑุงูุฏุง ุจุฑู",
        "image": "assets/family.png" # ุนฺฉุณPNG ฺฉู ุขูพููุฏ ฺฉุฑุฏ
    },
    3: {
        "name": "ุซุฑูุช ู ูุฑุงูุงู", 
        "folder": "wealth_abundance", 
        "emoji": "๐ฐ", 
        "color": "#f1c40f", 
        "description": "ุดฺฉุฑฺฏุฒุงุฑ ุจุฑุง ูุนูุชโูุง ูุงู ู ูุฑุงูุงู", 
        "author_quote": "ุซุฑูุช ูุงูุน ูุฑุงูุงู ุฏุฑ ุชูุงู ุฒูููโูุง ุฒูุฏฺฏ ุงุณุช - ุฑุงูุฏุง ุจุฑู",
        "image": "assets/wealth.png"
    },
    4: {
        "name": "ุดุงุฏ ู ุขุฑุงูุด", 
        "folder": "happiness_peace", 
        "emoji": "๐", 
        "color": "#3498db", 
        "description": "ุดฺฉุฑฺฏุฒุงุฑ ุจุฑุง ูุญุธุงุช ุดุงุฏ ู ุตูุญ ุฏุฑูู", 
        "author_quote": "ุดุงุฏ ุญูู ุงุฒ ุฏุฑูู ูโุฌูุดุฏ - ุฑุงูุฏุง ุจุฑู",
        "image": "assets/happiness.png"
    },
    5: {
        "name": "ุงูุฏุงู ู ููููุช", 
        "folder": "goals_success", 
        "emoji": "๐ฏ", 
        "color": "#e67e22", 
        "description": "ุดฺฉุฑฺฏุฒุงุฑ ุจุฑุง ุฑุดุฏุ ูพุดุฑูุช ู ุฏุณุชุงูุฑุฏูุง", 
        "author_quote": "ูุฑ ูุฏู ุจุง ุงููู ูุฏู ุดุฑูุน ูโุดูุฏ - ุฑุงูุฏุง ุจุฑู",
        "image": "assets/goals.png"
    },
    6: {
        "name": "ุฒูุฏฺฏ ูุทููุจ", 
        "folder": "quality_life", 
        "emoji": "๐", 
        "color": "#9b59b6", 
        "description": "ุดฺฉุฑฺฏุฒุงุฑ ุจุฑุง ุงูฺฉุงูุงุช ู ุฑูุงู ุฒูุฏฺฏ", 
        "author_quote": "ุฒูุฏฺฏ ูุฏูโุง ุงุณุช ฺฉู ุจุงุฏ ูุฏุฑุด ุฑุง ุจุฏุงูู - ุฑุงูุฏุง ุจุฑู",
        "image": "assets/quality.png"
    },
    7: {
        "name": "ุทุจุนุช ู ฺฉุงุฆูุงุช", 
        "folder": "nature_universe", 
        "emoji": "๐ฟ", 
        "color": "#27ae60", 
        "description": "ุดฺฉุฑฺฏุฒุงุฑ ุจุฑุง ุฒุจุงโูุง ุขูุฑูุด", 
        "author_quote": "ุทุจุนุช ุจูุชุฑู ูุนูู ุดฺฉุฑฺฏุฒุงุฑ ุงุณุช - ุฑุงูุฏุง ุจุฑู",
        "image": "assets/nature.png"
    },
    8: {
        "name": "ุนุดู ู ูุนููุช", 
        "folder": "love_spirituality", 
        "emoji": "๐", 
        "color": "#e84393", 
        "description": "ุดฺฉุฑฺฏุฒุงุฑ ุจุฑุง ุนุดู ุงูู ู ุฑุดุฏ ูุนูู", 
        "author_quote": "ุนุดู ูุฏุฑุชููุฏุชุฑู ูุฑู ุฌูุงู ุงุณุช - ุฑุงูุฏุง ุจุฑู",
        "image": "assets/love.png"
    }
}

# ุจูู ฺฉุฏูุง (WEEK_THEMESุ UserProgressManager ู ุชูุงุจุน) ุจุฏูู ุชุบุฑ ุจุงู ูโูุงููุฏ...
# (ูู ุจูู ฺฉุฏ ุดูุง ุฑุง ุญุฐู ูฺฉุฑุฏูุ ููฺฏุงู ฺฉูพ ฺฉุฑุฏู ููุท ุจุฎุด TOPICS ุฑุง ุจุง ูุณุฎู ุจุงูุง ุฌุงฺฏุฒู ฺฉูุฏ)
